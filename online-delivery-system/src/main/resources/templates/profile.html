<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P2P Online Delivery Platform - Profile Page</title>
    <link rel="stylesheet" href="/css/profile.css/">
</head>
<body>

<header>
    <h1>User Profile</h1>
</header>

<ul class="banner">
    <li><img src="images/logo_ld_png.png"></li>
    <li><a target="_parent" href="home">Home</a></li>
    <li><a target="_parent" href="about">About</a></li>
    <li><a target="_parent" href="order">Order</a></li>
    <li><a target="_parent" href="contact">Contact</a></li>
    <li class="right"><a target="_parent" href="login">Login</a></li>
    <li class="right"><a target="_parent" href="customerlogin">Sign up</a></li>
    <li class="right"><a target="_parent" href="restaurantlogin">Partner with us</a></li>
</ul>

<div id="profile-container">
    <div id="profile-picture">
        <input type="file" id="imageInput" accept="image/*" onchange="updateProfilePicture()">
        <label for="imageInput"><img src="/images" alt="Press To Enter Profile Picture" id="previewImage"></label>
    </div>

    <div id="user-details">
        <h1 id="name">Anthony Price</h1>
        <h2 id="job">Software Developer</h2>
        <p id="description">Passionate about coding and technology.</p>

        <button class="edit-profile" onclick="editProfile()">Edit Profile</button>
        <button class="subscription-button" id="view-subscription">View subscription</button>
        <button class="logout-button" id="logout">Logout</button>
    </div>

    <form id="edit-form">
        <h1 id="edit-profile" style="display: none">Edit Profile</h1>
        <label for="new-name">Name:</label>
        <input type="text" id="new-name" required><br>

        <label for="new-job">Job:</label>
        <input type="text" id="new-job" required><br>

        <label for="new-description">Description:</label>
        <textarea id="new-description" rows="4" required></textarea><br>

        <button type="button" onclick="saveProfile()">Save</button>
        <button type="button" id="edit-profile-header" style="display: none" onclick="returnToProfile()">Return</button>
        <button type="button" onclick="cancelEdit()">Cancel</button>
    </form>
</div>


<img src="images/background-aboutus.jpg" alt="" class="background-image">

<script>
    function updateProfilePicture() {
        var input = document.getElementById('imageInput');
        var preview = document.getElementById('previewImage');

        var file = input.files[0];

        if (file) {
            var reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
    }
    function editProfile() {
        document.getElementById('name').style.display = 'none';
        document.getElementById('job').style.display = 'none';
        document.getElementById('description').style.display = 'none';
        document.getElementById('view-subscription').style.display = 'none';
        document.getElementById('logout').style.display = 'none';

        document.getElementById('edit-form').style.display = 'block';
        document.getElementById('edit-profile-header').style.display = 'inline-block';
        document.getElementById('edit-profile').style.display = 'inline-block';

        // Set the current values in the form fields
        document.getElementById('new-name').value = document.getElementById('name').innerText;
        document.getElementById('new-job').value = document.getElementById('job').innerText;
        document.getElementById('new-description').value = document.getElementById('description').innerText;


        // Hide buttons in the user-details div
        document.querySelector('#user-details button').style.display = 'none';
    }

    function returnToProfile() {
        document.getElementById('name').style.display = 'block';
        document.getElementById('job').style.display = 'block';
        document.getElementById('description').style.display = 'block';
        document.getElementById('view-subscription').style.display = 'inline-block';
        document.getElementById('logout').style.display = 'inline-block';
        //document.getElementById('edit-profile').style.display = 'block';

        document.getElementById('edit-form').style.display = 'none';
        document.getElementById('edit-profile-header').style.display = 'none';
        document.getElementById('edit-profile').style.display = 'none';
    }

    function cancelEdit() {
        returnToProfile();
    }

    function saveProfile() {
        var name = document.getElementById('new-name').value;
        var job = document.getElementById('new-job').value;
        var description = document.getElementById('new-description').value;
        var profileData = {
            name: name,
            job: job,
            description: description,
            profilePicture: document.getElementById('previewImage').src
        };

        // Convert the profileData object to a JSON string
        var profileDataString = JSON.stringify(profileData);

        // Store the JSON string in the local storage
        localStorage.setItem('userProfile', profileDataString);

        // Inform the user that the profile has been saved
        alert("Profile saved!");

        //update the displayed details
        document.getElementById('name').innerText = name;
        document.getElementById('job').innerText = job;
        document.getElementById('description').innerText = description;

        returnToProfile();
    }
</script>
</body>
</html>